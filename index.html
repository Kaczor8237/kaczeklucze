<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KACZE KLUCZE | Najtańsze klucze do gier – Automatyczne ceny</title>
    <link rel="icon" href="logo.png" type="image/png">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">
    <script src="https://kit.fontawesome.com/452a5a5a5a.js" crossorigin="anonymous"></script>
    <style>
        :root {
            --gold: #ffc439;
            --dark: #0f0f0f;
            --darker: #111;
            --gray: #222;
            --light: #ddd;
        }
        * { margin:0; padding:0; box-sizing:border-box; }
        body { background:#000; color:#fff; font-family:'Rajdhani',sans-serif; line-height:1.6; overflow-x:hidden; }
        .topbar { background:var(--darker); padding:12px; text-align:center; font-size:15px; color:#aaa; border-bottom:1px solid #333; }
        
        header { text-align:center; padding:90px 20px 70px; background:var(--dark); }
        .logo img { width:170px; margin-bottom:20px; filter: drop-shadow(0 0 10px rgba(255,196,57,0.4)); }
        h1 { font-family:'Orbitron',sans-serif; font-size:82px; letter-spacing:7px; color:#fff; text-transform:uppercase; }
        .subtitle { font-size:26px; color:var(--gold); letter-spacing:5px; margin-top:12px; }

        /* Koszyk – ikona w prawym górnym rogu */
        .cart-icon {
            position:fixed; top:20px; right:20px; z-index:999; background:var(--gold); color:#000;
            width:60px; height:60px; border-radius:50%; display:flex; align-items:center; justify-content:center;
            font-size:28px; cursor:pointer; box-shadow:0 5px 20px rgba(255,196,57,0.4); transition:.3s;
        }
        .cart-icon:hover { transform:scale(1.1); }
        .cart-count { position:absolute; top:-8px; right:-8px; background:#ff4444; color:#fff; font-size:12px; width:22px; height:22px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:bold; }

        /* Panel koszyka */
        .cart-panel {
            position:fixed; right:-400px; top:0; width:380px; height:100%; background:#111; z-index:998; transition:right .4s ease; padding:20px; overflow-y:auto; box-shadow:-10px 0 30px rgba(0,0,0,0.8);
        }
        .cart-panel.open { right:0; }
        .cart-header { display:flex; justify-content:space-between; align-items:center; padding:15px 0; border-bottom:1px solid #333; margin-bottom:20px; }
        .cart-header h2 { font-size:24px; color:var(--gold); }
        .close-cart { font-size:28px; cursor:pointer; color:#aaa; }
        .cart-item { display:flex; justify-content:space-between; padding:15px 0; border-bottom:1px solid #333; }
        .cart-total { font-size:24px; font-weight:bold; color:var(--gold); text-align:right; margin:20px 0; }
        .checkout-btn { width:100%; padding:18px; background:var(--gold); color:#000; font-size:20px; font-weight:bold; border:none; cursor:pointer; border-radius:8px; }
        .checkout-btn:hover { background:#ffb800; }

        /* Wyszukiwanie i filtry */
        .search-section {
            max-width:1400px; margin:40px auto; padding:0 20px; display:flex; gap:20px; flex-wrap:wrap; align-items:center; justify-content:center;
        }
        #searchInput {
            padding:16px 20px; width:100%; max-width:500px; border-radius:8px; border:none; font-size:18px; background:var(--gray); color:#fff;
        }
        select {
            padding:16px 24px; border-radius:8px; border:none; background:var(--gray); color:#fff; font-size:16px; cursor:pointer;
        }

        /* Status cen */
        #priceStatus { text-align:center; margin:10px 0; color:var(--gold); font-size:14px; }

        /* Grid gier – jak w Instant Gaming */
        .games-grid {
            display:grid;
            grid-template-columns:repeat(auto-fill,minmax(300px,1fr));
            gap:20px;
            max-width:1400px;
            margin:40px auto;
            padding:0 20px;
        }
        .game-card {
            background:var(--darker);
            border-radius:8px;
            overflow:hidden;
            transition:all .3s ease;
            border:1px solid #333;
            text-align:center;
            box-shadow:0 2px 10px rgba(0,0,0,0.5);
        }
        .game-card:hover {
            transform:translateY(-5px);
            box-shadow:0 10px 25px rgba(255,196,57,0.2);
            border-color:var(--gold);
        }
        .game-img {
            width:100%;
            height:200px;
            background-size:cover;
            background-position:center;
            background-color:#333;
        }
        .game-info { padding:15px; }
        .game-title { font-size:18px; margin-bottom:8px; color:#fff; font-weight:600; line-height:1.3; height:50px; display:flex; align-items:center; justify-content:center; }
        .platform { font-size:12px; color:#888; margin-bottom:10px; text-transform:uppercase; letter-spacing:1px; }
        .platform i { color:var(--gold); margin-right:5px; }
        .prices { margin:10px 0; }
        .old-price { text-decoration:line-through; color:#666; font-size:14px; }
        .price { font-size:28px; font-weight:bold; color:var(--gold); margin:5px 0; }
        .price-note { font-size:12px; color:#aaa; margin-top:5px; }
        .buy-btn {
            width:100%; padding:12px; background:#007bff; color:#fff; font-weight:bold; font-size:16px; border:none; cursor:pointer; border-radius:0 0 8px 8px; transition:.3s;
        }
        .buy-btn:hover { background:var(--gold); color:#000; }

        footer { text-align:center; padding:90px 20px 50px; background:#000; }
        footer img { height:70px; margin-bottom:20px; filter: drop-shadow(0 0 10px rgba(255,196,57,0.3)); }
        footer p { color:#666; font-size:20px; letter-spacing:2px; }

        @media(max-width:768px){
            h1{font-size:56px;}
            .search-section{flex-direction:column;}
            #searchInput{max-width:100%;}
            .games-grid{grid-template-columns:repeat(auto-fill,minmax(250px,1fr)); gap:15px;}
        }
    </style>
</head>
<body>

<div class="topbar">
    PONAD 2500 SPRZEDANYCH KLUCZY • NATYCHMIASTOWA DOSTAWA • GWARANCJA 12 MIESIĘCY • AUTOMATYCZNE CENY Z RYNKU
</div>

<header>
    <div class="logo"><img src="logo.png" alt="KACZE KLUCZE"></div>
    <h1>KACZE KLUCZE</h1>
    <div class="subtitle">najtańsze klucze w Polsce • instant • bezpiecznie • ceny auto-aktualizowane</div>
</header>

<!-- Koszyk – ikona -->
<div class="cart-icon" onclick="toggleCart()">
    <i class="fas fa-shopping-cart"></i>
    <span class="cart-count" id="cartCount">0</span>
</div>

<!-- Panel koszyka -->
<div class="cart-panel" id="cartPanel">
    <div class="cart-header">
        <h2>Twój koszyk</h2>
        <span class="close-cart" onclick="toggleCart()">×</span>
    </div>
    <div id="cartItems"></div>
    <div class="cart-total">Razem: <span id="cartTotal">0</span> zł</div>
    <button class="checkout-btn" onclick="alert('Przekierowanie do płatności... (Przelewy24 / PayPal / Przelew)')">
        ZAMÓW I ZAPŁAĆ
    </button>
</div>

<div id="priceStatus">Ładowanie cen z rynku...</div>

<div class="search-section">
    <input type="text" id="searchInput" placeholder="Szukaj gry... (np. GTA, Cyberpunk, FIFA)">
    <select id="platformFilter">
        <option value="all">Wszystkie platformy</option>
        <option value="steam">Steam</option>
        <option value="origin">EA App / Origin</option>
        <option value="uplay">Ubisoft Connect</option>
        <option value="rockstar">Rockstar</option>
        <option value="battle">Battle.net</option>
        <option value="epic">Epic Games</option>
    </select>
    <select id="sortFilter">
        <option value="price-asc">Od najtańszych</option>
        <option value="price-desc">Od najdroższych</option>
        <option value="name">Alfabetycznie</option>
    </select>
</div>

<div class="games-grid" id="gamesGrid"></div>

<footer>
    <img src="logo.png" alt="KACZE KLUCZE">
    <p>KACZE KLUCZE © 2025 • Kontakt: kacze.klucze@gmail.com • Ceny auto-aktualizowane z Eneba/IG/G2A</p>
</footer>

<script>
// === BAZA GIER (50 tytułów) – z początkowymi cenami (zostaną nadpisane) ===
let games = [
    { title: "Grand Theft Auto V: Premium Edition", price: 69, oldPrice: 249, platform: "rockstar", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=GTA+V" },
    { title: "Red Dead Redemption 2", price: 119, oldPrice: 299, platform: "rockstar", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=RDR2" },
    { title: "Cyberpunk 2077: Ultimate Edition", price: 149, oldPrice: 349, platform: "steam", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Cyberpunk" },
    { title: "Mafia Trilogy", price: 79, oldPrice: 249, platform: "steam", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Mafia+Trilogy" },
    { title: "Batman: Arkham Collection", price: 49, oldPrice: 199, platform: "steam", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Batman+Collection" },
    { title: "The Witcher 3: Wild Hunt GOTY", price: 39, oldPrice: 149, platform: "steam", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Witcher+3" },
    { title: "EA Sports FC 25", price: 179, oldPrice: 349, platform: "origin", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=FC+25" },
    { title: "Call of Duty: Black Ops 6", price: 249, oldPrice: 349, platform: "battle", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Black+Ops+6" },
    { title: "Forza Horizon 5 Premium", price: 179, oldPrice: 399, platform: "steam", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Forza+5" },
    { title: "Elden Ring", price: 179, oldPrice: 249, platform: "steam", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Elden+Ring" },
    { title: "Baldur's Gate 3", price: 199, oldPrice: 249, platform: "steam", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=BG3" },
    { title: "Hogwarts Legacy", price: 119, oldPrice: 249, platform: "steam", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Hogwarts" },
    { title: "God of War (2018)", price: 89, oldPrice: 199, platform: "steam", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=God+of+War" },
    { title: "Spider-Man Remastered", price: 159, oldPrice: 249, platform: "steam", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Spider-Man" },
    { title: "Black Myth: Wukong", price: 219, oldPrice: 299, platform: "steam", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Wukong" },
    { title: "Star Wars Jedi: Survivor", price: 129, oldPrice: 299, platform: "origin", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Jedi+Survivor" },
    { title: "Assassin's Creed Valhalla", price: 69, oldPrice: 249, platform: "uplay", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=AC+Valhalla" },
    { title: "Far Cry 6", price: 69, oldPrice: 249, platform: "uplay", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Far+Cry+6" },
    { title: "Battlefield 2042", price: 79, oldPrice: 279, platform: "origin", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=BF+2042" },
    { title: "Rainbow Six Siege", price: 39, oldPrice: 89, platform: "uplay", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=R6+Siege" },
    { title: "Civilization VI Anthology", price: 69, oldPrice: 399, platform: "steam", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Civ+VI" },
    { title: "DOOM Eternal", price: 59, oldPrice: 169, platform: "steam", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=DOOM+Eternal" },
    { title: "Metro Exodus Gold Edition", price: 49, oldPrice: 169, platform: "steam", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Metro+Exodus" },
    { title: "Dying Light 2 Stay Human", price: 99, oldPrice: 249, platform: "steam", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Dying+Light+2" },
    { title: "Resident Evil 4 Remake", price: 139, oldPrice: 259, platform: "steam", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=RE4+Remake" },
    { title: "Horizon Zero Dawn Complete", price: 79, oldPrice: 199, platform: "steam", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Horizon+ZD" },
    { title: "Detroit: Become Human", price: 69, oldPrice: 169, platform: "steam", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Detroit" },
    { title: "Death Stranding Director's Cut", price: 89, oldPrice: 199, platform: "steam", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Death+Stranding" },
    { title: "Control Ultimate Edition", price: 59, oldPrice: 169, platform: "steam", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Control" },
    { title: "Sekiro: Shadows Die Twice GOTY", price: 129, oldPrice: 249, platform: "steam", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Sekiro" },
    { title: "Fallout 4 GOTY", price: 49, oldPrice: 169, platform: "steam", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Fallout+4" },
    { title: "Skyrim Special Edition", price: 49, oldPrice: 169, platform: "steam", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Skyrim" },
    { title: "Need for Speed Unbound", price: 89, oldPrice: 299, platform: "origin", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=NFS+Unbound" },
    { title: "The Sims 4 + Wszystkie DLC", price: 199, oldPrice: 999, platform: "origin", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Sims+4" },
    { title: "Minecraft Java + Bedrock", price: 109, oldPrice: 159, platform: "other", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Minecraft" },
    { title: "Counter-Strike 2 Prime", price: 49, oldPrice: 89, platform: "steam", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=CS2" },
    { title: "Rust", price: 99, oldPrice: 169, platform: "steam", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Rust" },
    { title: "ARK: Survival Evolved", price: 39, oldPrice: 129, platform: "steam", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=ARK" },
    { title: "Dead by Daylight", price: 39, oldPrice: 89, platform: "steam", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=DbD" },
    { title: "Phasmophobia", price: 49, oldPrice: 79, platform: "steam", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Phasmophobia" },
    { title: "Stardew Valley", price: 39, oldPrice: 59, platform: "steam", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Stardew" },
    { title: "Among Us", price: 15, oldPrice: 29, platform: "steam", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Among+Us" },
    { title: "Rocket League", price: 0, oldPrice: 79, platform: "epic", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Rocket+League" },
    { title: "Lies of P", price: 139, oldPrice: 249, platform: "steam", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Lies+of+P" },
    { title: "Dragon Age: The Veilguard", price: 249, oldPrice: 349, platform: "origin", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Dragon+Age" },
    { title: "Starfield", price: 179, oldPrice: 299, platform: "steam", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Starfield" },
    { title: "Avatar: Frontiers of Pandora", price: 129, oldPrice: 299, platform: "uplay", img: "https://via.placeholder.com/300x200/1a1a1a/fff?text=Avatar+Pandora" }
];

let cart = [];

// === API GG.deals – WLEJ SWÓJ KLUCZ TUTAJ ===
const API_KEY = 'TWÓJ_KLUCZ_GGDEALS_API'; // Zarejestruj się na gg.deals i weź darmowy klucz
const UPDATE_INTERVAL = 5 * 60 * 1000; // 5 minut

// Funkcja pobierania cen z GG.deals (agreguje Eneba, IG, G2A)
async function fetchMarketPrices(title) {
    try {
        const slug = title.toLowerCase().replace(/[^a-z0-9]/g, '-'); // Przybliżony slug (dla dokładności użyj appid Steam)
        const response = await fetch(`https://api.gg.deals/game/search/?title=${encodeURIComponent(title)}&api_key=${API_KEY}`);
        if (!response.ok) throw new Error('Błąd API');
        const data = await response.json();
        if (data.items && data.items.length > 0) {
            // Pobierz najniższą cenę w PLN z filtrami sklepów
            const minPrice = Math.min(...data.items
                .filter(item => ['eneba', 'instant-gaming', 'g2a'].includes(item.shop.id.toLowerCase()))
                .map(item => parseFloat(item.price_final / 100))); // Konwersja na PLN (GG.deals w centach)
            return minPrice;
        }
        return null; // Brak danych – zostaw starą cenę
    } catch (error) {
        console.error(`Błąd pobierania ceny dla ${title}:`, error);
        return null;
    }
}

// Aktualizacja cen dla wszystkich gier
async function updateAllPrices() {
    document.getElementById('priceStatus').textContent = 'Aktualizuję ceny z Eneba/IG/G2A...';
    let updatedCount = 0;
    for (let game of games) {
        const marketPrice = await fetchMarketPrices(game.title);
        if (marketPrice !== null && game.price > marketPrice) {
            game.price = marketPrice + 5; // +5 zł marży
            updatedCount++;
        }
        // Symulacja opóźnienia, żeby nie przekroczyć limitu API
        await new Promise(resolve => setTimeout(resolve, 100));
    }
    renderGames(games); // Odśwież grid
    document.getElementById('priceStatus').textContent = `Ceny zaktualizowane! Zmieniło się: ${updatedCount} gier. Następna aktualizacja za 5 min.`;
    alert(`Auto-update: Zaktualizowano ${updatedCount} cen! Sprawdź zmiany.`);
}

// Uruchom aktualizację co 5 min
updateAllPrices();
setInterval(updateAllPrices, UPDATE_INTERVAL);

// Reszta kodu (render, koszyk, filtry) – bez zmian
function renderGames(list) {
    const grid = document.getElementById('gamesGrid');
    if (list.length === 0) {
        grid.innerHTML = '<p style="grid-column:1/-1;text-align:center;color:#aaa;font-size:20px;">Nie znaleziono gier. Spróbuj inaczej!</p>';
        return;
    }
    grid.innerHTML = list.map(game => {
        const platformIcon = getPlatformIcon(game.platform);
        const priceText = game.price === 0 ? 'ZA DARMO' : `${game.price} zł`;
        const oldPriceHtml = game.oldPrice ? `<span class="old-price">${game.oldPrice} zł</span>` : '';
        const note = game.price > (game.oldPrice ? game.oldPrice - 100 : 0) ? '<span class="price-note">+5 zł marży (najniższa na rynku!)</span>' : '';
        return `
            <div class="game-card">
                <div class="game-img" style="background-image: url('${game.img}')"></div>
                <div class="game-info">
                    <div class="game-title">${game.title}</div>
                    <div class="platform"><i class="${platformIcon}"></i>${game.platform.toUpperCase()} • Global/EU</div>
                    <div class="prices">
                        ${oldPriceHtml}
                        <div class="price">${priceText}</div>
                        ${note}
                    </div>
                    <button class="buy-btn" onclick="addToCart('${game.title}', ${game.price})">KUP TERAZ</button>
                </div>
            </div>
        `;
    }).join('');
}

function getPlatformIcon(platform) {
    const icons = {
        steam: 'fab fa-steam',
        origin: 'fab fa-ea',
        uplay: 'fas fa-gamepad',
        rockstar: 'fas fa-star',
        battle: 'fas fa-blizzard',
        epic: 'fab fa-epic-games',
        other: 'fas fa-globe'
    };
    return icons[platform] || 'fas fa-gamepad';
}

function addToCart(title, price) {
    cart.push({ title, price });
    updateCart();
    alert(`Dodano: ${title} za ${price} zł`);
}

function updateCart() {
    document.getElementById('cartCount').textContent = cart.length;
    document.getElementById('cartTotal').textContent = cart.reduce((sum, i) => sum + i.price, 0);
    const items = document.getElementById('cartItems');
    items.innerHTML = cart.map((item, index) => `
        <div class="cart-item">
            <div>${item.title}</div>
            <div><strong>${item.price} zł</strong> <span style="color:#aaa;cursor:pointer;margin-left:10px" onclick="removeFromCart(${index})">✕</span></div>
        </div>
    `).join('') || '<p style="text-align:center;color:#888;">Koszyk pusty</p>';
}

function removeFromCart(index) {
    cart.splice(index, 1);
    updateCart();
}

function toggleCart() {
    document.getElementById('cartPanel').classList.toggle('open');
}

// Filtry
document.getElementById('searchInput').addEventListener('input', filterGames);
document.getElementById('platformFilter').addEventListener('change', filterGames);
document.getElementById('sortFilter').addEventListener('change', filterGames);

function filterGames() {
    let filtered = games.slice();
    const query = document.getElementById('searchInput').value.toLowerCase();
    const platform = document.getElementById('platformFilter').value;
    const sort = document.getElementById('sortFilter').value;

    if (query) filtered = filtered.filter(g => g.title.toLowerCase().includes(query));
    if (platform !== 'all') filtered = filtered.filter(g => g.platform === platform);

    if (sort === 'price-asc') filtered.sort((a, b) => a.price - b.price);
    if (sort === 'price-desc') filtered.sort((a, b) => b.price - a.price);
    if (sort === 'name') filtered.sort((a, b) => a.title.localeCompare(b.title));

    renderGames(filtered);
}

// Start
renderGames(games);
</script>
</body>
</html>
